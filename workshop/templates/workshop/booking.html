{% extends "base.html" %}
{% load static %}
{% url 'account_login' as login_url %}
{% url 'update_booking' as update_booking_url %}
{% url 'delete_booking' as delete_booking_url %}
{% load crispy_forms_tags %}

{% block content %}

<!-- Create New Bookings -->
 <div class="container">
  <div class="row shadow-sm p-3 mb-5 bg-light rounded justify-content-center">
    <div class="col-sm-10 col-md-8 col-lg-6">
      <div class="card-body justify-content-center">
        {% if user.is_authenticated %}      
        <h3 id="CREATE">Hi {{ user.username }}!</h3>
        <h4>Ready to Clay Around?</h4>
        <form method="post" class="mt-4 d-grid gap-3">
            <div>
                {{ booking_form | crispy }}
                {% csrf_token %}
            </div>
            <div class="col-md-auto">
                <button id="CREATE" type="submit"
                class="btn btn-success mt-3"
                style="border: 3px dashed #28a745; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); border-radius: 10px;">Book Your Spot!
                </button>
            </div> 
        </form>
        <!-- CHANGE - Place this code somewhere else -->
        {% else %}
        <p>Please <a href="{% url 'account_login' %}" class="btn-lg rounded-pill">login</a> to book a workshop.</p>
        {% endif %}
      </div>
    </div>
  </div>
 </div>

<!-- Visualize your Bookings -->
{% if user.is_authenticated %}
<div class="row justify-content-center" id="booking-table" style="margin-top: 20px;">
    <div class="col-md-8">
        <h2>My Bookings</h2>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col">Workshop</th>
                    <th scope="col">Participants</th>
                    <th scope="col">Appointment date</th>
                </tr>
            </thead>
            <tbody>
                {% for booking in bookings %}
                <tr>
                    <td>{{ booking.workshop.name }}</td>
                    <td>{{ booking.participants }}</td>
                    <td>{{ booking.appointment_date }}</td>
                    <td><a href="{% url 'update_booking' booking.id %}" class="btn btn-success mt-2 rounded-pill">Update Booking</a>
                    <td><a href="{% url 'delete_booking' booking.id %}" class="btn btn-warning mt-2 rounded-pill">Delete Booking</a>
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="3">You haven't made any bookings yet.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endif %}
</div>

 

 {% endblock %}
